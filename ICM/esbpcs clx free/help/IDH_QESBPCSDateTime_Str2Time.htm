<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
<META NAME="GENERATOR" Content="Time2HELP 1.0; Standard Template">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=iso-8859-1">
<TITLE>Str2Time</TITLE>
<Style>Body, TD {font-family: "Verdana"; font-size: 10pt};
PRE {font-size: 10pt; margin-top: 0; margin-bottom: 0}
TR.odd {background-color: #F8F8F8};
TR.even {background-color: #EEEEEE};
Table.list {background-color: #FFFFFF};
TD {vertical-align : top}
</Style>
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<BASEFONT NAME="verdana" Size="2"><Table Border="0" Width="100%" BGColor="#FFFFFF"><TR><TD><Font Color="#000000F"><B>Str2Time Function</B></Font></TD></TR></Table>Converts a string containing a Time into a DateTime.<P><B>Unit</B><Br><A HREF="IDH_Unit_QESBPCSDateTime.htm">QESBPCSDateTime</A><P><B>Declaration</B><Br><Font Face="Courier New"><B>Function</B> Str2Time(<B>const</B> TimeStr: <B>string</B>): TDateTime;</Font><P><B>Description</B><Br />The following are all exceptable separators for entry: [':', '.'] though the current TimeSeparator will be used for display Times can be entered without Separators but Leading Zeroes must then be used and the format is assumed to be either HHMM or HHMMSS.</P><P><Table Border="0" Width="100%" BGColor="#000000"><TR><TD><Font Color="#FFFFFF"><B>Parameters</B></Font></TD></TR></Table><Table Class="list" Width="100%" CellSpacing="1" CellPadding="2" BGColor="#EEEEEE"><TR Class="even"><TD><Font Color="Blue">TimeStr&nbsp;</Font></TD><TD>The String to convert.</TD></TR></Table></P><P><B>Category</B><Br><A HREF="idh_cat_dtconv.htm">Date/Time Conversion Routines</A><Br /><Font Color=#FF0000><H3>Implementation</H3></Font> <table border="0" bgcolor="#FFFED9"  style="margin-top: 10; margin-bottom: 10;"> <tr> <td><pre><B>function</B> Str2Time (<B>const</B> TimeStr: <B>string</B>): TDateTime;
<B>var</B>
     S: <B>string</B>;
<B>begin</B>
     S := Trim (TimeStr);
     <B>if</B> S = <Font Color="#119911">''</Font> <B>then</B>
     <B>begin</B>
          Result := 0.0;
          Exit;
     <B>end</B>;

     <B>if</B> IsDigitStr (S) <B>then</B>
     <B>begin</B>
          <B>case</B> Length (S) <B>of</B>
               4: S := LeftStr (S, 2) + TimeSeparator + RightStr (S, 2);
               6: S := LeftStr (S, 2) + TimeSeparator + Copy (S, 3, 2)
                    + TimeSeparator + Copy (S, 5, 2);
          <B>end</B>;
     <B>end</B>;

     <B>try</B>
          <Font Color="#0000DD">// Allow '.' and ':' as valid alternatives for TimeSeparator</Font>
          S := ReplaceChStr (S, <Font Color="#119911">'.'</Font>, TimeSeparator);
          S := ReplaceChStr (S, <Font Color="#119911">':'</Font>, TimeSeparator);
          <Font Color="#0000DD">// S := ReplaceChStr ( S, ' ', TimeSeparator);</Font>

          <Font Color="#0000DD">// Remove trailing Separator if any</Font>
          <B>if</B> S [Length (S)] = TimeSeparator <B>then</B>
          <B>begin</B>
               S := LeftStr (S, Length (S) - 1);
               <B>if</B> S = <Font Color="#119911">''</Font> <B>then</B>
               <B>begin</B>
                    Result := 0.0;
                    Exit;
               <B>end</B>;
          <B>end</B>;

          <Font Color="#0000DD">//Frac ensures the Date Component is 0</Font>
          Result := Frac (StrToTime (S));
     <B>except</B>
          Result := 0.0;
          <B>if</B> ESBRaiseDateError <B>then</B>
               <B>raise</B>;
     <B>end</B>;
<B>End</B>;</pre></td></tr></Table><P><HR>
<TABLE BORDER="0" WIDTH="100%" BGCOLOR="#000000"><TR><TD>
<Font Color=White><Large>HTML generated by <B>Time2HELP</B></Large></Font>
</TD></TR></Table>
<Small><A HREF="http://www.time2help.com">http://www.time2help.com</A></Small></Body></HTML>