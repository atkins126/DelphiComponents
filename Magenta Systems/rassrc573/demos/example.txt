TMAGRAS - DELPHI RAS COMPONENT - EXAMPLE PROGRAMS
=================================================

Last Updated: 20th August 2010
by Angus Robertson, Magenta Systems Ltd, England

Email: delphi@magsys.co.uk, http://www.magsys.co.uk/delphi/
Copyright Magenta Systems Ltd, 2010

Compatible with Delphi 6, 7, 2005, 2006, 2007, 2009, 2010 and XE.

------------------------------------------------------------------------

20th August 2010 - Release 5.60

Removed all cast warning from the demos for Delphi 2009 and later, tested
on Delphi XE.
Added missing EXNEWM and TAPIDEMO to the rasdemos project group.


4th August 2008 - Release 5.40

All demos have been tested with Delphi 2009, note these demos currently all
use ANSI RAS API calls and not WideString/Unicode.


16th August 2007 - Release 5.30

RASDEMO4
- Added 'Save logon for anyone who uses this computer' tickbox when
saving a logon


24th May 2007 - Release 5.21

- Updated all applications to correctly use phonebooks, and therefore
  work on Vista and XP with non-admin operators


24 Oct 2005 - Release 5.0

RASDEMO4
- force dial subentry to be 1 or higher
- removed IP Helper functions to simplify distribution
- removed demo programs for IP Helper and WMI/SMART


11th Oct 2002 - Release 4.94

EXEDITC
- added magsubs1 needed for version check
TESTWMI1
- new demo application for WMI and SMART


26th July 2002 - Release 4.9

EXPERF
- added magsubs1 needed for version check

SCUTTEST
- new demo for short cut testing

TESTMULTI
- new demo to test multiple DUN connection entries


11th October 2001 - Release 4.7

EXPERF
- corrected check for W2K to also check XP

TCPIPMon
- New demo from Dirk Claessens that illustrates use of the IP Helper APIs.


30 April 2001 - Release 4.60

Several examples - removed phonebook sort, since now done in component

RASDEMO4
- added Ras Admin/Server component, on new RAS Server tab
- added rasphone.pbk support to create connection entry list, 100 times faster than
    using RAS APIs on NT4/W2K, shown on new Entry List tab
- now using phonebook path/name when getting and putting entries to make sure
  they go back where they came from (paths also shown when editing)
- new entries on W2K can be specified to go into user or allusers phonebooks


23 Jan 2001 - Release 4.51

EXDIALC fixes and improvements:
- replaced MagRasConStateChanged with MagRasConStateEvent
- corrected some state events suppressed, particularly with multilink
- display dial info for separate sub entries with multilink

EXEDITC fixes and improvements:
- added Encryption Type = Optional which is default for W2K

RASDEMO4
- removed StateChanged event handler and replaced it with StateEvent
  which uses a message queue to buffer callback events that caused re-entrancy
  and which fixes the long term cosmetic problem in this demo program where a
  second row appeared incorrectly in the ListView
- added Encryption Type = Optional which is default for W2K
- set SubEntry to 0 before dialling to dial all subentries with multilink


------------------------------------------------------------------------

To assist developers getting started with the Magenta Systems Ltd
TMagRas Delphi component, a number of simple example programs are
provided.  Note that these programs only work with Release 4.4 and
later of the component.  TMagRas must be installed on the palette before
opening any project files.  The examples are very minimalist, but all
perfectly acceptable. If opened in Delphi 4 or 5 click to ignore
unsupported properties.

------------------------------------------------------------------------

EXMON - Monitor Example

Monitors for RAS connections started by other applications, and
allows hang-up.

Files: exmon.dpr, exmon0.pas, exmon0.dfm

------------------------------------------------------------------------

EXDIALS - Dialling Simple Example

Dial, monitor and hang-up a RAS connection using information
already specified in the phonebook entry.

Files: exdials.dpr, exdials0.pas, exdials0.dfm

------------------------------------------------------------------------

EXDIALC - Dialling Complex Example

Dial, monitor and hang-up a RAS connection, allowing the user to change
the telephone number and logon details, and dialling location.

Files: exdialc.dpr, exdialc0.pas, exdialc0.dfm

------------------------------------------------------------------------

EXPERF - Performance Example

Shows the performance of RAS connections started by other applications,
and allows hang-up.

Files: experf.dpr, experf0.pas, experf0.dfm

------------------------------------------------------------------------

EXNEW - New Entry Example

Create a new entry in the RAS phonebook (ie a new connection). It shows
the minimal options requited for a new entry, which will be created with
TCP/IP, PPP and dynamic IP addresses.

Files: exnew.dpr, exnew0.pas, exnew0.dfm

------------------------------------------------------------------------

EXNEWM - New Entry Example (Modem)

Create a new entry in the RAS phonebook (ie a new connection). It shows
the minimal options requited for a new entry, which will be created with
TCP/IP, PPP and dynamic IP addresses. Takes the modem from the default
connection, ignores strange devices like VPN.

Files: exnew.dpr, exnew0.pas, exnew0.dfm

------------------------------------------------------------------------
EXEDITS - Edit Entry Simple Example

Edit the properties of an entry in the RAS phonebook (ie a connection).
This simple version only shows the minimal options that are typically
edited by the user.

Files: exedits.dpr, exedits0.pas, exedits0.dfm

------------------------------------------------------------------------

EXEDITC - Edit Entry Complex Example

Edit the properties of an entry in the RAS phonebook (ie a connection).
This complex version shows all the properties that can be edited.
The demo shows properties that are NT4 and/or Windows 2000 specific,
when ideally those edit boxes should be hidden if not supported.
Likewise several other options could be suppressed if not valid (like IP
addresses).

Files: exeditc.dpr, exeditc0.pas, exeditc0.dfm

------------------------------------------------------------------------

RASDEMO4 - Full Demo Program

In addition to these example programs, there is a full demonstration
program that makes use of virtually all the functionality in the TMagRas
release 4 components, and is indeed the main test application used during
development.

The main difference from the examples above is that monitoring of
multiple calls and separate channels of multilink calls is supported.

Files: rasdemo4.dpr, demo4.pas, demo4.dfm.

------------------------------------------------------------------------

SCUTTEST - Short Cut Testing


Allows a short cut to be created for a DUN connection entry on the
desktop.  Primarily a test program for magsubs2.pas.


Files: scuttest.dpr, scutmain.pas, scutmain.dfm

------------------------------------------------------------------------

TESTMULTI - Test Multiple DUN Connection Entries

A test program to create and delete multiple DUN connection entries,
up to 999 at a time (but don't try that many).  This is primarily to
allow RAS applications to be tested with hundreds of test entries.

Files: testmulti.dpr, testmmain.pas, testmmain.dfm


------------------------------------------------------------------------



