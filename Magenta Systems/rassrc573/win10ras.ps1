# Windows Powershell script to update a registry key - needs administrator rights
# Note: .reg files can not update the MultiString key type done here, which is why a .ps1 script file is needed.
#
# This patch fixes a Windows 10 version 1703 (March 2017) build 15063 RAS problem that
# caused all dial-up calls to fail with error 633.
#
# If you want to use regedit manually, the change made by this script is to add "SeLoadDriverPrivilege"
# to the list of six existing values in the HLM\SYSTEM\CurrentControlSet\Services\RasMan\RequiredPrivileges key.
#
# The PC must be restarted after this script is run before RAS will dial correctly.
#
# Created and digitally signed 6 June 2017 by Magenta Systems Ltd, https://www.magsys.co.uk/dunman/
# for our DUN Manager software.
#
# Powershell must be run with administrator rights to access to HLM keys.
# Once in the correct directory, precede the script name with .\ to run it, ie .\win10ras.ps1
# Powershell may be configured to stop scripts being run, so you may need to type the following at the PS> prompt:
# Set-ExecutionPolicy RemoteSigned
#
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\RasMan" -name:"RequiredPrivileges" -Value "SeImpersonatePrivilege","SeIncreaseQuotaPrivilege","SeTcbPrivilege","SeChangeNotifyPrivilege","SeCreateGlobalPrivilege","SeAssignPrimaryTokenPrivilege","SeLoadDriverPrivilege" -Type:MultiString -force


# SIG # Begin signature block
# MIIbYQYJKoZIhvcNAQcCoIIbUjCCG04CAQExDzANBglghkgBZQMEAgEFADB5Bgor
# BgEEAYI3AgEEoGswaTA0BgorBgEEAYI3AgEeMCYCAwEAAAQQH8w7YFlLCE63JNLG
# KX7zUQIBAAIBAAIBAAIBAAIBADAxMA0GCWCGSAFlAwQCAQUABCAs+iDEr+I/P1sf
# i55XmZ5e1dzwoiUhXnfMU/knJpdGNKCCCjUwggTUMIIDvKADAgECAhACQBoDlyR6
# slVfJQz2InA2MA0GCSqGSIb3DQEBCwUAMH8xCzAJBgNVBAYTAlVTMR0wGwYDVQQK
# ExRTeW1hbnRlYyBDb3Jwb3JhdGlvbjEfMB0GA1UECxMWU3ltYW50ZWMgVHJ1c3Qg
# TmV0d29yazEwMC4GA1UEAxMnU3ltYW50ZWMgQ2xhc3MgMyBTSEEyNTYgQ29kZSBT
# aWduaW5nIENBMB4XDTE2MTEyNTAwMDAwMFoXDTE3MTIyNTIzNTk1OVowbDELMAkG
# A1UEBhMCR0IxDzANBgNVBAgMBlN1cnJleTEQMA4GA1UEBwwHQ3JveWRvbjEcMBoG
# A1UECgwTTWFnZW50YSBTeXN0ZW1zIEx0ZDEcMBoGA1UEAwwTTWFnZW50YSBTeXN0
# ZW1zIEx0ZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOoaRiTtIb7a
# a3aEJyxPzLIf3LCeeAIfOE7h/CANK2K0iW4k07+B+l8kv8nW8a1hHbfp9bgcbn+b
# TAQfyylW6g/1300Eugqychgrw0brTubkH5oBcSWkRVU2Rw1qGCuQB4nJvIXc8CTE
# RYEbTEakvIAxBoXtS9cDqWM5jyHoc/dUSmdM+gBuCPnpGiRbr2r5iIqgbe7Xu958
# Vek2fAGLHaF4+2tW7o+e1jSXsn3cgJWgwIsfi1hLTA3tSbCl5Oo4f44oFlk5uGN1
# kS7LHjylw5Q2eYDwrn81fOmhfjxSB8i9ADRvRl7sTaRxS/QlNzgJzHoXsJbL162L
# UTXfPeVDXZ0CAwEAAaOCAV0wggFZMAkGA1UdEwQCMAAwDgYDVR0PAQH/BAQDAgeA
# MCsGA1UdHwQkMCIwIKAeoByGGmh0dHA6Ly9zdi5zeW1jYi5jb20vc3YuY3JsMGEG
# A1UdIARaMFgwVgYGZ4EMAQQBMEwwIwYIKwYBBQUHAgEWF2h0dHBzOi8vZC5zeW1j
# Yi5jb20vY3BzMCUGCCsGAQUFBwICMBkMF2h0dHBzOi8vZC5zeW1jYi5jb20vcnBh
# MBMGA1UdJQQMMAoGCCsGAQUFBwMDMFcGCCsGAQUFBwEBBEswSTAfBggrBgEFBQcw
# AYYTaHR0cDovL3N2LnN5bWNkLmNvbTAmBggrBgEFBQcwAoYaaHR0cDovL3N2LnN5
# bWNiLmNvbS9zdi5jcnQwHwYDVR0jBBgwFoAUljtT8Hkzl699g+8uK8zKt4YecmYw
# HQYDVR0OBBYEFE8krFdOnTxyIz1iU87pPaXy3uS0MA0GCSqGSIb3DQEBCwUAA4IB
# AQBYbQflxKqooR0Dk7zHnuHumV26TyJ2dA2jRwaI5QXqgVptm7TjazKDzg/b8Xej
# jFMzKnI7SFEloxKhg8AYETJ5pP8kPFSKIvhyoSyijTA5GZ1qOAp+HaSqunkSaM60
# jrCu7r9g12SIONJEDnuu3jm1hDnWfpOKcwsTirR/WJRXhckphbJgFzcIT8OFuAl9
# prrer4q7QC5KzOxzFER3eJfM4Df44tJIsQsBfp1KRGEt5KVweSEfRxAUnzSQ7tVx
# bc7c1iWP2NCS2VKnaZcDz3YLWqnJkKoW3bdyEZa/iFIidztdykj+RWbRvfuYEXC2
# V1TKj0qEBuAsWB92WrbD4Bg1MIIFWTCCBEGgAwIBAgIQPXjX+XZJYLJhffTwHsqG
# KjANBgkqhkiG9w0BAQsFADCByjELMAkGA1UEBhMCVVMxFzAVBgNVBAoTDlZlcmlT
# aWduLCBJbmMuMR8wHQYDVQQLExZWZXJpU2lnbiBUcnVzdCBOZXR3b3JrMTowOAYD
# VQQLEzEoYykgMjAwNiBWZXJpU2lnbiwgSW5jLiAtIEZvciBhdXRob3JpemVkIHVz
# ZSBvbmx5MUUwQwYDVQQDEzxWZXJpU2lnbiBDbGFzcyAzIFB1YmxpYyBQcmltYXJ5
# IENlcnRpZmljYXRpb24gQXV0aG9yaXR5IC0gRzUwHhcNMTMxMjEwMDAwMDAwWhcN
# MjMxMjA5MjM1OTU5WjB/MQswCQYDVQQGEwJVUzEdMBsGA1UEChMUU3ltYW50ZWMg
# Q29ycG9yYXRpb24xHzAdBgNVBAsTFlN5bWFudGVjIFRydXN0IE5ldHdvcmsxMDAu
# BgNVBAMTJ1N5bWFudGVjIENsYXNzIDMgU0hBMjU2IENvZGUgU2lnbmluZyBDQTCC
# ASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAJeDHgAWryyx0gjE12iTUWAe
# cfbiR7TbWE0jYmq0v1obUfejDRh3aLvYNqsvIVDanvPnXydOC8KXyAlwk6naXA1O
# pA2RoLTsFM6RclQuzqPbROlSGz9BPMpK5KrA6DmrU8wh0MzPf5vmwsxYaoIV7j02
# zxzFlwckjvF7vjEtPW7ctZlCn0thlV8ccO4XfduL5WGJeMdoG68ReBqYrsRVR1PZ
# szLWoQ5GQMWXkorRU6eZW4U1V9Pqk2JhIArHMHckEU1ig7a6e2iCMe5lyt/51Y2y
# NdyMK29qclxghJzyDJRewFZSAEjM0/ilfd4v1xPkOKiE1Ua4E4bCG53qWjjdm9sC
# AwEAAaOCAYMwggF/MC8GCCsGAQUFBwEBBCMwITAfBggrBgEFBQcwAYYTaHR0cDov
# L3MyLnN5bWNiLmNvbTASBgNVHRMBAf8ECDAGAQH/AgEAMGwGA1UdIARlMGMwYQYL
# YIZIAYb4RQEHFwMwUjAmBggrBgEFBQcCARYaaHR0cDovL3d3dy5zeW1hdXRoLmNv
# bS9jcHMwKAYIKwYBBQUHAgIwHBoaaHR0cDovL3d3dy5zeW1hdXRoLmNvbS9ycGEw
# MAYDVR0fBCkwJzAloCOgIYYfaHR0cDovL3MxLnN5bWNiLmNvbS9wY2EzLWc1LmNy
# bDAdBgNVHSUEFjAUBggrBgEFBQcDAgYIKwYBBQUHAwMwDgYDVR0PAQH/BAQDAgEG
# MCkGA1UdEQQiMCCkHjAcMRowGAYDVQQDExFTeW1hbnRlY1BLSS0xLTU2NzAdBgNV
# HQ4EFgQUljtT8Hkzl699g+8uK8zKt4YecmYwHwYDVR0jBBgwFoAUf9Nlp8Ld7Lvw
# MAnzQzn6Aq8zMTMwDQYJKoZIhvcNAQELBQADggEBABOFGh5pqTf3oL2kr34dYVP+
# nYxeDKZ1HngXI9397BoDVTn7cZXHZVqnjjDSRFph23Bv2iEFwi5zuknx0ZP+XcnN
# XgPgiZ4/dB7X9ziLqdbPuzUvM1ioklbRyE07guZ5hBb8KLCxR/Mdoj7uh9mmf6RW
# pT+thC4p3ny8qKqjPQQB6rqTog5QIikXTIfkOhFf1qQliZsFay+0yQFMJ3sLrBkF
# IqBgFT/ayftNTI/7cmd3/SeUx7o1DohJ/o39KK9KEr0Ns5cF3kQMFfo2KwPcwVAB
# 8aERXRTl4r0nS1S+K4ReD6bDdAUK75fDiSKxH3fzvc1D1PFMqT+1i4SvZPLQFCEx
# ghCCMIIQfgIBATCBkzB/MQswCQYDVQQGEwJVUzEdMBsGA1UEChMUU3ltYW50ZWMg
# Q29ycG9yYXRpb24xHzAdBgNVBAsTFlN5bWFudGVjIFRydXN0IE5ldHdvcmsxMDAu
# BgNVBAMTJ1N5bWFudGVjIENsYXNzIDMgU0hBMjU2IENvZGUgU2lnbmluZyBDQQIQ
# AkAaA5ckerJVXyUM9iJwNjANBglghkgBZQMEAgEFAKCBkDAZBgkqhkiG9w0BCQMx
# DAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgELMQ4wDAYKKwYBBAGCNwIBFTAkBgor
# BgEEAYI3AgEMMRYwFKASgBAAVwBpAG4AMQAwAFIAYQBzMC8GCSqGSIb3DQEJBDEi
# BCDXnFOwmayvXzf6KAm4zAGp5KfKmO8iOXqEewq8vW71STANBgkqhkiG9w0BAQEF
# AASCAQCJTsbgsvv17ERcFkSD/OZghKETflxDy23PDa3BvVsQN0tOu48iy3sd0UU4
# ZUMqMSUIKxjplAa5lRgWFGwh6FX2+ahcBT9pVhlKbi+x1CxUMM/msPms4l3SLIxj
# AJTZJC/3tH2jN64z1zzCMpQAH71FYzfIgzQieDiHfEwXzYe3l8vA5kFradybGrcM
# eUIQlXpaPyPYeaHN9siwX6a2+u5rm9DCJwgVmcnodgEyMVbS9tHtzX30HPcqpdHh
# pka4rSDgqydwbJTblhRYP+59ITHWbyrPCujmcSvE8eoNTQvXEQixd6gvJ9P7oix3
# gbdY19jwi4gJYs7dIwLpD5fR80xwoYIOLDCCDigGCisGAQQBgjcDAwExgg4YMIIO
# FAYJKoZIhvcNAQcCoIIOBTCCDgECAQMxDTALBglghkgBZQMEAgEwgf8GCyqGSIb3
# DQEJEAEEoIHvBIHsMIHpAgEBBgtghkgBhvhFAQcXAzAhMAkGBSsOAwIaBQAEFGHZ
# wCY99Ve1iBV8vp5GQ4xGb9Y+AhUAp9ARr6Z0r8vNH8sc2PZAzraPgjcYDzIwMTcw
# NjA2MTUzMjM1WjADAgEeoIGGpIGDMIGAMQswCQYDVQQGEwJVUzEdMBsGA1UEChMU
# U3ltYW50ZWMgQ29ycG9yYXRpb24xHzAdBgNVBAsTFlN5bWFudGVjIFRydXN0IE5l
# dHdvcmsxMTAvBgNVBAMTKFN5bWFudGVjIFNIQTI1NiBUaW1lU3RhbXBpbmcgU2ln
# bmVyIC0gRzKgggqLMIIFODCCBCCgAwIBAgIQewWx1EloUUT3yYnSnBmdEjANBgkq
# hkiG9w0BAQsFADCBvTELMAkGA1UEBhMCVVMxFzAVBgNVBAoTDlZlcmlTaWduLCBJ
# bmMuMR8wHQYDVQQLExZWZXJpU2lnbiBUcnVzdCBOZXR3b3JrMTowOAYDVQQLEzEo
# YykgMjAwOCBWZXJpU2lnbiwgSW5jLiAtIEZvciBhdXRob3JpemVkIHVzZSBvbmx5
# MTgwNgYDVQQDEy9WZXJpU2lnbiBVbml2ZXJzYWwgUm9vdCBDZXJ0aWZpY2F0aW9u
# IEF1dGhvcml0eTAeFw0xNjAxMTIwMDAwMDBaFw0zMTAxMTEyMzU5NTlaMHcxCzAJ
# BgNVBAYTAlVTMR0wGwYDVQQKExRTeW1hbnRlYyBDb3Jwb3JhdGlvbjEfMB0GA1UE
# CxMWU3ltYW50ZWMgVHJ1c3QgTmV0d29yazEoMCYGA1UEAxMfU3ltYW50ZWMgU0hB
# MjU2IFRpbWVTdGFtcGluZyBDQTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC
# ggEBALtZnVlVT52Mcl0agaLrVfOwAa08cawyjwVrhponADKXak3JZBRLKbvC2Sm5
# Luxjs+HPPwtWkPhiG37rpgfi3n9ebUA41JEG50F8eRzLy60bv9iVkfPw7mz4rZY5
# Ln/BJ7h4OcWEpe3tr4eOzo3HberSmLU6Hx45ncP0mqj0hOHE0XxxxgYptD/kgw0m
# w3sIPk35CrczSf/KO9T1sptL4YiZGvXA6TMU1t/HgNuR7v68kldyd/TNqMz+CfWT
# N76ViGrF3PSxS9TO6AmRX7WEeTWKeKwZMo8jwTJBG1kOqT6xzPnWK++32OTVHW0R
# OpL2k8mc40juu1MO1DaXhnjFoTcCAwEAAaOCAXcwggFzMA4GA1UdDwEB/wQEAwIB
# BjASBgNVHRMBAf8ECDAGAQH/AgEAMGYGA1UdIARfMF0wWwYLYIZIAYb4RQEHFwMw
# TDAjBggrBgEFBQcCARYXaHR0cHM6Ly9kLnN5bWNiLmNvbS9jcHMwJQYIKwYBBQUH
# AgIwGRoXaHR0cHM6Ly9kLnN5bWNiLmNvbS9ycGEwLgYIKwYBBQUHAQEEIjAgMB4G
# CCsGAQUFBzABhhJodHRwOi8vcy5zeW1jZC5jb20wNgYDVR0fBC8wLTAroCmgJ4Yl
# aHR0cDovL3Muc3ltY2IuY29tL3VuaXZlcnNhbC1yb290LmNybDATBgNVHSUEDDAK
# BggrBgEFBQcDCDAoBgNVHREEITAfpB0wGzEZMBcGA1UEAxMQVGltZVN0YW1wLTIw
# NDgtMzAdBgNVHQ4EFgQUr2PWyqNOhXLgp7xB8ymiOH+AdWIwHwYDVR0jBBgwFoAU
# tnf6aUhHn1MS1cLqBzJ2B9GXBxkwDQYJKoZIhvcNAQELBQADggEBAHXqsC3VNBlc
# MkX+DuHUT6Z4wW/X6t3cT/OhyIGI96ePFeZAKa3mXfSi2VZkhHEwKt0eYRdmIFYG
# mBmNXXHy+Je8Cf0ckUfJ4uiNA/vMkC/WCmxOM+zWtJPITJBjSDlAIcTd1m6JmDy1
# mJfoqQa3CcmPU1dBkC/hHk1O3MoQeGxCbvC2xfhhXFL1TvZrjfdKer7zzf0D19n2
# A6gP41P3CnXsxnUuqmaFBJm3+AZX4cYO9uiv2uybGB+queM6AL/OipTLAduexzi7
# D1Kr0eOUA2AKTaD+J20UMvw/l0Dhv5mJ2+Q5FL3a5NPD6itas5VYVQR9x5rsIwON
# hSrS/66pYYEwggVLMIIEM6ADAgECAhBUWPKq10HWRLyEqXugllLmMA0GCSqGSIb3
# DQEBCwUAMHcxCzAJBgNVBAYTAlVTMR0wGwYDVQQKExRTeW1hbnRlYyBDb3Jwb3Jh
# dGlvbjEfMB0GA1UECxMWU3ltYW50ZWMgVHJ1c3QgTmV0d29yazEoMCYGA1UEAxMf
# U3ltYW50ZWMgU0hBMjU2IFRpbWVTdGFtcGluZyBDQTAeFw0xNzAxMDIwMDAwMDBa
# Fw0yODA0MDEyMzU5NTlaMIGAMQswCQYDVQQGEwJVUzEdMBsGA1UEChMUU3ltYW50
# ZWMgQ29ycG9yYXRpb24xHzAdBgNVBAsTFlN5bWFudGVjIFRydXN0IE5ldHdvcmsx
# MTAvBgNVBAMTKFN5bWFudGVjIFNIQTI1NiBUaW1lU3RhbXBpbmcgU2lnbmVyIC0g
# RzIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCZ8/zYBAkDhvnXXKaT
# wEJ86nxjz10A4o7zwJDfjyn1GOqUt5Ll17Cgc4Ho6QqbSnwB/52PpDmnDupF9CIM
# OnDtOUWL5MUbXPBFaEYkBWN2mxz8nmwqsVblin9Sca7yNdVGIwYcz0gtHbTNuNl2
# I44c/z6/uwZcaQemZQ74Xq59Lu1NrjXvydcAQv0olQ6fXXJCCbzD2kTS7cxHhOT8
# yi2sWL6u967ZRA0It8J31hpDcNFuA95SksQQCHHZuiJV8h+87ZudO+JeHUyD/5cP
# ewvnVYNO0g3rvtfsrm5HuZ/fpdZRvARV7f8ncEzJ7SpLE+GxuUwPyQHuVWVfaQJ4
# Zss/AgMBAAGjggHHMIIBwzAMBgNVHRMBAf8EAjAAMGYGA1UdIARfMF0wWwYLYIZI
# AYb4RQEHFwMwTDAjBggrBgEFBQcCARYXaHR0cHM6Ly9kLnN5bWNiLmNvbS9jcHMw
# JQYIKwYBBQUHAgIwGRoXaHR0cHM6Ly9kLnN5bWNiLmNvbS9ycGEwQAYDVR0fBDkw
# NzA1oDOgMYYvaHR0cDovL3RzLWNybC53cy5zeW1hbnRlYy5jb20vc2hhMjU2LXRz
# cy1jYS5jcmwwFgYDVR0lAQH/BAwwCgYIKwYBBQUHAwgwDgYDVR0PAQH/BAQDAgeA
# MHcGCCsGAQUFBwEBBGswaTAqBggrBgEFBQcwAYYeaHR0cDovL3RzLW9jc3Aud3Mu
# c3ltYW50ZWMuY29tMDsGCCsGAQUFBzAChi9odHRwOi8vdHMtYWlhLndzLnN5bWFu
# dGVjLmNvbS9zaGEyNTYtdHNzLWNhLmNlcjAoBgNVHREEITAfpB0wGzEZMBcGA1UE
# AxMQVGltZVN0YW1wLTIwNDgtNTAdBgNVHQ4EFgQUCbXB/pZylylDmsngArqu+P0v
# uvYwHwYDVR0jBBgwFoAUr2PWyqNOhXLgp7xB8ymiOH+AdWIwDQYJKoZIhvcNAQEL
# BQADggEBABezCojpXFpeIGs7ChWybMWpijKH07H0HFOuhb4/m//XvLeUhbTHUn6U
# 6L3tYbLUp5nkw8mTwTU9C+hoCl1WmL2xIjvRRHrXv/BtUTKK1SPfOAE39uJTK3or
# EY+3TWx6MwMbfGsJlBe75NtY1CETZefs0SXKLHWanH/8ybsqaKvEfbTPo8lsp9nE
# AJyJCneR9E2i+zE7hm725h9QA4abv8tCq+Z2m3JaEQGKxu+lb5Xn3a665iJl8BhZ
# GxHJzYC32JdHH0II+KxxH7BGU7PUstWjq1B1SBIXgq3P4EFPMn7NlRy/kYoIPaSn
# ZwKW3yRMpdBBwIJgo4oXMkvTvM+ktIwxggJaMIICVgIBATCBizB3MQswCQYDVQQG
# EwJVUzEdMBsGA1UEChMUU3ltYW50ZWMgQ29ycG9yYXRpb24xHzAdBgNVBAsTFlN5
# bWFudGVjIFRydXN0IE5ldHdvcmsxKDAmBgNVBAMTH1N5bWFudGVjIFNIQTI1NiBU
# aW1lU3RhbXBpbmcgQ0ECEFRY8qrXQdZEvISpe6CWUuYwCwYJYIZIAWUDBAIBoIGk
# MBoGCSqGSIb3DQEJAzENBgsqhkiG9w0BCRABBDAcBgkqhkiG9w0BCQUxDxcNMTcw
# NjA2MTUzMjM1WjAvBgkqhkiG9w0BCQQxIgQgsaiwVpgWI5N0w1ZTozez7kOSQ1N2
# 0A3a7/Ub3hvbBpEwNwYLKoZIhvcNAQkQAi8xKDAmMCQwIgQgz3rBetBH7NX9w2gi
# AxsS1O8Hi28rTF5rpB+P8s9LrWcwCwYJKoZIhvcNAQEBBIIBAAClHWU4eOuVO2LB
# keDoNDlcLhvboagRJei1bMxmT9N+igUOpZTXUujcZp545djFvfqH2g3Geh1OlRO3
# fL8+Rme/YJyPcTz3qipkqYQxDrkE+bUiRrdVQJ0gK80OmF9Olrb5ad5ulVZgKEwU
# zHWDbgiQPkqIhLsf7o8URl86zcCmmlZzXyYM+7Q3L+N4Gx5wTnWgd7MXWP0wCtG4
# ObXs++IkLnRCnlxNMvE2oVqFxIrAd1V31vXywyXKA+NS4K9R8249gt02Gjqf+oYa
# si+B8qHSTpHFD+ImM/lNO7MfSdLSxXe92HlTHpGRfFcAZ8K/WQAfvB8e9Y7aKXxv
# WeiWiOs=
# SIG # End signature block
