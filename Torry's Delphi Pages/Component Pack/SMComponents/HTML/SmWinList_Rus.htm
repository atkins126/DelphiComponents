<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Компонент TSmWinList</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
</head>

<body>
<table width="75%" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td width="6%"><img src="4.jpg" width="40" height="42"></td>
    <td width="40%"><strong>Компонент TSmWinList</strong></td>
    <td width="54%"><div align="right"><a href="ReadMe_Rus.htm">Главная страница</a></div></td>
  </tr>
  <tr>
    <td colspan="3"><p>&nbsp;</p>
      <p>Компонент TSmLogEvent 
      предназначен для получения списка открытых окон, а также их хэндлы. Можно
          производить фильтрацию всех окон или только видимых окон. Кроме того
          можно выделить имя и хэндл активного окна.</p>      
      <p><font size="+1"><strong>Свойства компонента</strong></font></p>
      <ul>
        <li><strong>property</strong> ActiveWinHdl:
            LongWord - хэндл активного окна</li>
        <li><strong>property</strong> ActiveWinName:
        string - имя активного окна</li>
        <li><strong>property</strong> Count: integer - количество открытых окон</li>
        <li><strong>property</strong> WinType: TTypeOfWindows - тип получаемого списка: все окна
          или только видимые. </li>
        <li><strong>Type</strong> TTypeOfWindows
            = (wnAll, wnVisible); wnAll - все окна, wnVisible - видимые окна.</li>
        <li><strong>property</strong> Items[Index: integer]: TWinList; - Отдельно
          взятое окно.</li>
        <li> TWinList = <strong>record</strong><br>
WinName: string; - <font color="#0099FF">имя окна</font><br>
Hdl: HWND; - <font color="#0099FF">хэндл окна</font><br>
<strong>end</strong>;</li>
      </ul>      
      <p><font size="+1"><strong>Методы компонента</strong></font></p>
      <ul>
        <li><strong>method</strong> Refresh;
              - обновляет список открытых окон.</li>
      </ul>      <p><font size="+1"></font></p>
      <p>Пример создания компонента в run-time, получение списка видимых окон
        и выделение активного окна.</p>
	   <PRE>
      <strong>var</strong>
          SmWinList1: TSmWinList;
          i: integer; 
      <strong>begin</strong>
          SmWinList1 := TSmWinList.Create(<strong>nil</strong>);
          SmWinList1.WinType := wnVisible;<font color="#0066FF">      //Определяем что необходимы только видимые окна</font>
          SmWinList1.Refresh; <font color="#0066FF">        //Получение списка окон</font>
          <strong>for</strong> i:=0 <strong>to</strong> SmWinList1.Count-1 <strong>do</strong> <font color="#0066FF">       //Обработкасписка открытых окон</font>
              <strong>begin</strong>
              StringGrid1.Cells[0,i+1] := SmWinList1[i].WinName;
              StringGrid1.Cells[1,i+1] := IntToStr(SmWinList1[i].Hdl);
             <strong>end</strong>;<br>
         StringGrid1.RowCount := SmWinList1.Count+1;
         Edit1.Text := IntToStr(SmWinList1.Count); <font color="#0066FF">       //Кол-во окон</font>
         Edit2.Text := SmWinList1.ActiveWinName; <font color="#0066FF">      //Имя активного окна</font>
         Edit3.Text := IntToStr(SmWinList1.ActiveWinHdl); <font color="#0066FF">     //Хэндл активного окна</font>
     <strong>end;</strong>
	  </PRE>
	       </p>
    </td>
  </tr>
  <tr>
    <td colspan="3">&nbsp;</td>
  </tr>
</table>
<p>&nbsp;</p>
</body>
</html>
